utilities functions for version 2.