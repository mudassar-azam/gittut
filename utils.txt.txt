utilities functions for version1